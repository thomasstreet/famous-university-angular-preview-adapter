<!DOCTYPE html>
<html>
<head>
	<title>Famo.us University | Famo.us/Angular</title>
	
	<style>
		body,html{margin:0px; overflow:hidden;}
	</style>
</head>
<body>

	<script type="text/javascript" src="bower_components/angular/angular.js"></script>
	<script type="text/javascript" src="bower_components/famous/famous-global.js"></script>
	<script type="text/javascript" src="bower_components/famous-angular/dist/famous-angular.js"></script>

	<div id="app-container" ng-app="famous-university" style="width:100%;">
		<div id="content-container"></div>
	</div>


	<script type="text/javascript">
		angular.module('famous-university', ['famous.angular']);
		angular.module('famous-university').controller('TestCtrl', function($scope){ $scope.test = 'wooooo!';})
	</script>

	<script type="text/javascript">
		
		var _previousHTMLNode = undefined;

		window._handlerFunctions = {
			css: function(cssString){
				document.querySelector('head').innerHTML = "<style>html, body{margin: 0; padding: 0;} " + cssString + "</style>";
			},
			html: function(htmlString){
				var injector = angular.injector(['ng','famous-university']);
				injector.invoke(function($rootScope, $compile){
					var container = document.querySelector('#content-container');
					if(_previousHTMLNode !== undefined) container.removeChild(_previousHTMLNode);
					var node = $compile(htmlString)($rootScope);
					console.log('new node', node)
					container.appendChild(node[0]);
				})
			},
			js: function(jsString){
				console.log('evaling', jsString)
				eval(jsString);
			}
		}

		window.setFamousContent = function(content) {
			angular.forEach(['js', 'css', 'html'], function(prop){
				if(prop !== undefined) _handlerFunctions[prop](content[prop]);
			});
		}

		window.setFamousContent({
			html: "<div ng-controller='TestCtrl'>{{test}}test</div>",
			js: "angular.module('famous-university').controller('TestCtrl', function($scope){ $scope.test = 'wooooo!';})",
			css: ""
		});

	</script>

</body>
</html>










